'use strict';window.tsfemForm={nonce:tsfemFormL10n.nonce,i18n:tsfemFormL10n.i18n,callee:tsfemFormL10n.callee,parseElementData:function(a,b){let c=tsfemForm.getElementData(a,b),d;try{d=c&&JSON.parse(c)}catch(f){d=c}finally{return d}},getElementData:function(a,b){return 0===b.indexOf('data-')&&(b=jQuery.camelCase(b.slice(5))),!!a.dataset.hasOwnProperty(b)&&a.dataset[b]},setupIterations:function(){let a=jQuery('.tsfem-form-iterator-selector-wrap input');if(a.length){tsfemForm.prepareItItems(a),tsfemForm.prepareCollapseItems();let d,f,g,m,n,o,p,q,b=0,c=3e3,h=0,j=0,k=2;const r=function(){d=document.createElement('span'),d.className='tsfem-form-iterator-timer',f=document.createElement('span'),f.style.width='0%',d.appendChild(f)};r(),g=c/(100*k),g*=0.975;const s=function(){f.style.width=++h/k+'%'},t=function(){h=0,f.style.width='0%',d.classList.remove('tsfem-form-iterator-timer-invalid')},u=function(){h=100,f.style.width=h+'%',d.classList.add('tsfem-form-iterator-timer-invalid')},v=function(){p&&p.remove(),n=o=p=void 0,r(),setTimeout(function(){a.prop('disabled',!1)},500),a.off('input.fIt'),a.on('input.fIt',m)},x=function(){q&&(q.value=q.dataset.tsfemFormPrevValue)};let y=jQuery(window);y.on('tsfemForm.iterationFail',x),y.on('tsfemForm.iterationLoad tsfemForm.deiterationLoad tsfemForm.iterationFail',v),y.on('tsfemForm.iterationComplete tsfemForm.deiterationComplete tsfemForm.iterationFail',function(){a.off('input.fIt'),a=jQuery('.tsfem-form-iterator-selector-wrap input'),tsfemForm.prepareItItems(a),tsfemForm.prepareCollapseItems(),tsfemForm.setupGeo(),a.on('input.fIt',m),jQuery(window).trigger('tsfem-reset-tooltips'),q=void 0}),m=function(z){return clearInterval(j),clearTimeout(b),t(),tsfemForm.disableSubmit(z.target.form),q=z.target,z.target.checkValidity()?void(j=setInterval(s,g),!n&&(n=jQuery(z.target),o=n.closest('.tsfem-form-setting').find('.tsfem-form-setting-label-inner-wrap'),a.not(z.target).prop('disabled',!0),o.append(d),p=o.find('span.tsfem-form-iterator-timer')),b=setTimeout(function(){if(n.prop('disabled',!0),clearInterval(j),f.style.width='100%',+z.target.value==+z.target.dataset.tsfemFormPrevValue)v(),tsfemForm.enableSubmit(z.target.form);else if(+z.target.value<+z.target.dataset.tsfemFormPrevValue)tsfemForm.unloadIterations(z.target),tsfemForm.enableSubmit(z.target.form);else if(40<+z.target.value){200<+z.target.value?tsfem.dialog({title:tsfemFormL10n.i18n.performanceWarning,text:[tsfemFormL10n.i18n.itHugeConfirm,tsfemFormL10n.i18n.aysProceed],confirm:tsfemFormL10n.i18n.proceed,cancel:tsfemFormL10n.i18n.cancel}):tsfem.dialog({title:tsfemFormL10n.i18n.performanceWarning,text:[tsfemFormL10n.i18n.itLargeConfirm,tsfemFormL10n.i18n.aysProceed],confirm:tsfemFormL10n.i18n.proceed,cancel:tsfemFormL10n.i18n.cancel});let A={};A._cancel=function(){x(),v(),A._reset(),tsfemForm.enableSubmit(z.target.form)},A._confirm=function(){tsfemForm.loadIterations(z.target),A._reset()},A._reset=function(){window.removeEventListener('tsfem_modalCancel',A._cancel),window.removeEventListener('tsfem_modalConfirm',A._confirm)},window.addEventListener('tsfem_modalCancel',A._cancel),window.addEventListener('tsfem_modalConfirm',A._confirm)}else tsfemForm.loadIterations(z.target)},c)):void u()},a.on('input.fIt',m)}},unloadIterations:function(a){if(a){let b=a.id.slice(0,a.id.lastIndexOf('[')),c=document.getElementById(b+'-wrapper');c.style.willChange='contents';let d=jQuery(window),f=jQuery(c).children('.tsfem-form-collapse').slice(a.value);d.trigger('tsfemForm.deiterationLoad',[a,f]),f.remove(),d.trigger('tsfemForm.deiterationComplete'),c.style.willChange='auto'}},loadIterations:function(a){if(a){let b=a.id.slice(0,a.id.lastIndexOf('[')),c=jQuery(a).closest('.tsfem-pane-wrap').find('.tsfem-pane-header .tsfem-ajax'),d=0,f='',g=document.getElementById(b+'-wrapper'),h=document.createElement('div');h.className='tsfem-flex-status-loading tsfem-flex tsfem-flex-center',h.appendChild(document.createElement('span')),g.appendChild(h),tsfem.resetAjaxLoader(c),tsfem.setAjaxLoader(c),jQuery.ajax({method:'POST',url:ajaxurl,dataType:'html',data:{action:'tsfemForm_iterate',nonce:tsfemForm.nonce,args:{caller:b,callee:tsfemForm.callee,previousIt:a.dataset.tsfemFormPrevValue,newIt:a.value}},timeout:1e4,async:!0}).done(function(j,k,l){let m=l.getResponseHeader('content-type'),n=jQuery(window);n.trigger('tsfemForm.iterationLoad'),-1<m.indexOf('json')?(a.value=a.dataset.tsfemFormPrevValue,tsfem.unexpectedAjaxErrorNotice(j),f=tsfem.i18n.InvalidResponse,n.trigger('tsfemForm.iterationFail')):(jQuery(g).append(j),d=1,n.trigger('tsfemForm.iterationComplete'))}).fail(function(j,k,l){f=tsfem.getAjaxError(j,k,l),l&&tsfem.setTopNotice(-1,'jQ error: '+l),jQuery(window).trigger('tsfemForm.iterationFail')}).always(function(){g.removeChild(h),tsfemForm.enableSubmit(a.form),tsfem.updatedResponse(c,d,f,0)})}},prepareItItems:function(a){a.each(function(b,c){c.dataset.tsfemFormPrevValue=c.value})},setupGeo:function(){if(jQuery('[data-geo-api-component="action"]').length){let b,c,a=!1;(function(){b=document.createElement('div'),b.className='tsfem-form-setting-action tsfem-flex',b.dataset.geoApiIsButtonWrap=1,b.style.opacity=0;let s=document.createElement('button');s.className='tsfem-button-primary tsfem-button-green tsfem-button-cloud',s.innerHTML=tsfemForm.i18n.validate,s.type='button',b.appendChild(s),c=document.createElement('div'),c.className='tsfem-description tsfem-form-option-description',c.dataset.geoApiIsButtonWarning=1,c.style.opacity=0,c.innerHTML=tsfemForm.i18n.reverseGeoWarning})();const d=function(s,t){let u=jQuery(s).closest('[data-geo-api-component="action"]'),v=l(u);a=!0,v.each(function(w,x){let y=tsfemForm.parseElementData(x,'geoApiComponent'),z={};y='object'==typeof y&&y||{0:y};loopComponents:for(let A in y){if(t.hasOwnProperty(y[A]))switchComponents:switch(y[A]){case'route':case'street_number':if(1<y.length){if(z[y[A]]=t[y[A]],1<Object.keys(z).length){x.value=z.route+' '+z.street_number;break loopComponents}break switchComponents}else{x.value=t[y[A]];break loopComponents}break;case'locality':case'country':case'postal_code':case'region':x.value=t[y[A]];break loopComponents;case'lat':case'lng':x.value=parseFloat(parseFloat(t[y[A]]).toFixed(7));break loopComponents;default:break loopComponents;}continue}jQuery(x).trigger('change')}),a=!1},f=function(s,t){let u={},v={};loopData:for(let w in t){let x=t[w].address_components,y=t[w].geometry.location;u[w]={},v[w]=t[w].formatted_address,u[w].lat=y.lat,u[w].lng=y.lng;loopComponents:for(let z in x){let A=x[z].short_name,B=x[z].types;loopTypes:for(let C in B)switchTypes:switch(B[C]){case'route':case'street_number':case'country':case'postal_code':u[w][B[C]]=A;break loopTypes;case'locality':u[w].locality=A;break loopTypes;case'postal_town':B.locality||(u[w].locality=A);break loopTypes;case'administrative_area_level_1':u[w].region=A;break loopTypes;case'administrative_area_level_2':B.administrative_area_level_1||(u[w].region=A);break loopTypes;default:break switchTypes;}}1<t.length&&!u[w].hasOwnProperty('route')&&(delete u[w],delete v[w])}if(!Object.keys(u).length)tsfem.setTopNotice(17004),k(jQuery(s).closest('[data-geo-api-component="action"]'));else{tsfem.dialog({title:tsfemFormL10n.i18n.selectAddressTitle,text:tsfemFormL10n.i18n.selectAddressText,select:v,confirm:tsfemFormL10n.i18n.select,cancel:tsfemFormL10n.i18n.cancel});let w={};w._cancel=function(){tsfemForm.enableButton(s),w._close()},w._confirm=function(x){if('checked'in x.detail){let y=u[x.detail.checked];void 0!==y&&d(s,y)}k(jQuery(s).closest('[data-geo-api-component="action"]')),w._close()},w._close=function(){window.removeEventListener('tsfem_modalCancel',w._cancel),window.removeEventListener('tsfem_modalConfirm',w._confirm)},window.addEventListener('tsfem_modalCancel',w._cancel),window.addEventListener('tsfem_modalConfirm',w._confirm)}},g=function(s){let t=jQuery(s.target).closest('[data-geo-api-component="action"]'),u=l(t),v={};tsfemForm.disableButton(s.target),u.each(function(x,y){y.value&&(v[y.dataset.geoApiComponent]=y.value)});let w={target:s.target,callbacks:{success:f,failure:function(){tsfemForm.enableButton(s.target)},always:function(){}}};tsfemForm.getGeoData(v,s.target.dataset.formId,w)},h=function(s,t,u){if(u=void 0===u?1:u,!u)return k(s);let v=s&&s.find('.tsfem-form-multi-setting-label-inner-wrap');if(v.length){if(!s.data('geo-api-has-button')){let x=b.cloneNode(!0);v.append(x),s.data('geo-api-has-button',1),x.getElementsByTagName('button')[0].dataset.formId=t,x.getElementsByTagName('button')[0].addEventListener('click',g),tsfem.fadeIn(x,300)}let w=v.find('[data-geo-api-is-button-warning]').first();if(2===u){if(w.length)return;let x=c.cloneNode(!0);v.append(x),tsfem.fadeIn(x,300)}else{if(!w.length)return;tsfem.fadeOut(w[0],300,()=>w[0].remove())}}},j=function(s,t,u){h(s,t,u)},k=function(s){let t=s&&s.find('.tsfem-form-multi-setting-label-inner-wrap')||void 0;t&&t.find(t.children('[data-geo-api-is-button-wrap], [data-geo-api-is-button-warning]')).fadeOut(300,function(){this.remove(),s.removeData('geo-api-has-button')})},l=function(s){return s.find('[data-geo-api="1"]')},m=function(s){let t=l(s);if(!t.length)return 0;let x,u=0,v=t.filter('[data-geo-api-component="lat"]').first().val(),w=t.filter('[data-geo-api-component="lng"]').first().val();if(t.each(function(y,z){if(-1<jQuery(z).data('geo-api-component').indexOf('route'))return x=z.value,!1}),v&&w)u=/^(\-|\+)?([0-9]+(\.[0-9]+)?)$/.test(v)&&-90<=v&&90>=v?2:0,u=u&&/^(\-|\+)?([0-9]+(\.[0-9]+)?)$/.test(w)&&-180<=w&&180>=w?2:0;else if(x&&(u=/^((([0-9\/-]+([\/-0-9A-Z]+)?(\s|(,\s)))([\u00a1-\uffffa-zA-Z\.\s]|[0-9_/-])+))|(([\u00a1-\uffffa-zA-Z\.\s]|[0-9_/-])+)((\s|(,\s))([0-9\/-]+([\/-0-9A-Z]+)?))$/.test(x)?1:0,!u)){let y=0;t.not('[data-geo-api-component="lat"], [data-geo-api-component="lng"]').each((z,A)=>{if(A.value.length&&1<++y)return!1}),u=1<y}return u};let n=0;const p=function(s){a||(clearTimeout(n),n=setTimeout(function(){if(tsfemForm.getElementData(s.target,'geoApiComponent')){let t=jQuery(s.target).closest('[data-geo-api-component="action"]'),u=m(t);t.data('geo-api-has-button')?u?j(t,s.target.form.id,u):k(t):h(t,s.target.form.id,u)}},500))};let q=jQuery('input[data-geo-api="1"]'),r=jQuery('select[data-geo-api="1"]');q&&(q.off('input.tsfemForm.addButtonIfValid'),q.on('input.tsfemForm.addButtonIfValid',p)),r&&(r.off('change.tsfemForm.addButtonIfValid'),r.on('change.tsfemForm.addButtonIfValid',p))}},getGeoData:function(a,b,c){let d=document.getElementById(b),g=jQuery(d).closest('.tsfem-pane-wrap').find('.tsfem-pane-header .tsfem-ajax'),h=0,j='';return tsfemForm.disableSubmit(d),tsfem.resetAjaxLoader(g),tsfem.setAjaxLoader(g),jQuery.ajax({method:'POST',url:ajaxurl,dataType:'json',data:{action:'tsfemForm_get_geocode',nonce:tsfemForm.nonce,input:JSON.stringify(a)},processData:!0,timeout:14000,async:!0}).done(function(k){k=tsfem.convertJSONResponse(k),tsfem.debug&&console.log(k);let l=k&&k.data||void 0,m=k&&k.type||void 0;l&&m?'failure'===m?(tsfem.unexpectedAjaxErrorNotice(k),c.callbacks.failure(c.target)):'geodata'in l&&(h=1,c.callbacks.success(c.target,l.geodata.results)):j=tsfem.i18n.InvalidResponse}).fail(function(k,l,m){j=tsfem.getAjaxError(k,l,m),tsfem.setTopNotice(17200),m&&tsfem.setTopNotice(-1,'jQ error: '+m),c.callbacks.failure(c.target)}).always(function(){tsfem.updatedResponse(g,h,j,0),tsfemForm.enableSubmit(d),c.callbacks.always(c.target)})},prepareCollapseItems:function(){let b=jQuery('.tsfem-form-collapse > input');b.off('change.tsfemForm.prepareItems'),b.on('change.tsfemForm.prepareItems',function(c){tsfemForm.prepareCollapseTitles(c),tsfemForm.prepareCollapseValidity(c)})},prepareCollapseTitles:function(a){const b=function(f){let g=jQuery(f.data._tsfemFormLabel),h=g.find('.tsfem-form-collapse-title'),j=g.data('dyntitleprep'),k=jQuery(f.target).val();k?h.text(j+' - '+k):h.text(j)},c=function(f){let g=jQuery(f.data._tsfemFormLabel),h=g.find('.tsfem-form-collapse-title'),j=g.data('dyntitleprep'),k=[];jQuery(f.data._tsfemFormThings).map((m,n)=>{n.checked&&k.push(n.value)});let l=k.join(', ');l?h.text(j+' - '+l):h.text(j)};(function(f){let g=jQuery(f.target).siblings('label'),h=g.data('dyntitletype'),j=g.data('dyntitleid')+'['+g.data('dyntitlekey')+']';switch(h){case'single':let k=document.getElementById(j);f.target.checked?jQuery(k).off('input.tsfemForm.doTitleChangeSingle'):jQuery(k).on('input.tsfemForm.doTitleChangeSingle',{_tsfemFormLabel:g},b);break;case'plural':let l=jQuery(document.getElementById(j)).find('input[type=checkbox]');f.target.checked?l.off('change.tsfemForm.doTitleChangePlural'):l.on('change.tsfemForm.doTitleChangePlural',{_tsfemFormLabel:g,_tsfemFormThings:l},c);}})(a)},prepareCollapseValidity:function(a){const b=function(h,j){let k='tsfem-form-collapse-header-error',l='tsfem-form-collapse-header-good',m='.tsfem-form-title-icon',n='tsfem-form-title-icon-unknown',o='tsfem-form-title-icon-error',p='tsfem-form-title-icon-good';0<j?(h.removeClass(l).addClass(k),h.find(m).removeClass(n+' '+p).addClass(o)):0>j?(h.removeClass(k+' '+l).addClass(l),h.find(m).removeClass(p+' '+o).addClass(n)):(h.removeClass(k).addClass(l),h.find(m).removeClass(n+' '+o).addClass(p))},c=function(h,j){let k,l;h.each(function(m,n){k=jQuery(n),l=(+k.data('tsfemErrorCount')||0)+j,k.data('tsfemErrorCount',l),b(k,l)})},d=function(h){let j=0;j='tsfemWasValid'in h.target.dataset?+h.target.dataset.tsfemWasValid:h.target.dataset.tsfemWasValid=1;let k=h.target.disabled||h.target.checkValidity(),l=jQuery(h.target).parents('.tsfem-form-collapse').children('.tsfem-form-collapse-header'),m=+l.data('tsfemErrorCount');m?j&&!k?(h.target.dataset.tsfemWasValid=+k,c(l,1)):!j&&k&&(h.target.dataset.tsfemWasValid=+k,c(l,-1)):k?c(l,0):(h.target.dataset.tsfemWasValid=+k,c(l,1))},f=function(h,j){let k=h.dataset.tsfemDidInitialValidation||0;k||(j.on('tsfemForm.first.checkValidity',d),j.each((l,m)=>{jQuery(m).trigger('tsfemForm.first.checkValidity')}),j.off('tsfemForm.first.checkValidity'),h.dataset.tsfemDidInitialValidation=1)};(function(h){let j=jQuery(h.target).siblings('.tsfem-form-collapse-content').find('input, select, textarea').not('.tsfem-form-collapse-checkbox');j.off('change.tsfemForm.checkValidity'),h.target.checked||(j.on('change.tsfemForm.checkValidity',d),f(h.target,j))})(a),tsfemForm.prepareCustomChecks(d),tsfemForm.prepareDeiterationValidityChecks(d)},prepareCustomChecks:function(a){const b=function(g,h){if(h){let j=jQuery(h);j.length&&(j.one('tsfemForm.temp.customChecks.checkValidityCb',a),j.trigger('tsfemForm.temp.customChecks.checkValidityCb'))}},c=function(){jQuery(window).on('tsfemForm.customValidationChecks',b)},d=function(){jQuery(window).off('tsfemForm.customValidationChecks')};(function(){d(),c();let g=jQuery(window);g.off('tsfemForm.iterationLoad.customValidation'),g.off('tsfemForm.iterationFail.customValidation'),g.off('tsfemForm.iterationComplete.customValidation'),g.on('tsfemForm.iterationLoad.customValidation',d),g.on('tsfemForm.iterationFail.customValidation',c),g.on('tsfemForm.iterationComplete.customValidation',c)})()},triggerCustomValidation:function(a){a instanceof HTMLElement&&jQuery(window).trigger('tsfemForm.customValidationChecks',[a])},prepareDeiterationValidityChecks:function(a){const b=function(d,f,g){if(g){let h=g.children('.tsfem-form-collapse-content').find('input:invalid, select:invalid, textarea:invalid');h&&(h.prop('disabled',!0),h.on('tsfemForm.temp.disableAndValidate.checkValidityCb',a),h.each((j,k)=>{jQuery(k).trigger('tsfemForm.temp.disableAndValidate.checkValidityCb')}),h.off('tsfemForm.temp.disableAndValidate.checkValidityCb'))}};(function(){let d=jQuery(window);d.off('tsfemForm.deiterationLoad.disableAndValidate'),d.on('tsfemForm.deiterationLoad.disableAndValidate',b)})()},setupSpecialRequired:function(){let a='tsfem-form-checkbox-required',b=document.createElement('input');(function(){b.className=a,b.setAttribute('type','checkbox'),b.setAttribute('required','required'),b.setAttribute('value','1'),b.setAttribute('tabIndex','-1')})();const c=function(j,k){let l=(+j.data('required-check-count')||0)+k;return j.data('required-check-count',l),l},d=function(j){if(!j.children('.'+a).length){let k=b.cloneNode(!1);k.setCustomValidity(tsfemForm.i18n.requiredSelectAny),jQuery(k).prependTo(j),tsfemForm.triggerCustomValidation(k)}j.removeClass('tsfem-form-multi-valid').addClass('tsfem-form-multi-invalid')},f=function(j){let k=j.children('.'+a);if(k.length){let l=k[0].cloneNode(!1);k.remove(),l.checked=!0,l.required=!1,jQuery(l).prependTo(j),tsfemForm.triggerCustomValidation(l),l.remove()}j.removeClass('tsfem-form-multi-invalid').addClass('tsfem-form-multi-valid')},g=function(j){if(!j.target.disabled){let m,k=jQuery(j.target).closest('.tsfem-form-multi-select-wrap[data-required="1"]'),l=k.data('required-check-count');m=j.target.checked?c(k,1):c(k,-1),1>l?m>l&&f(k):1>m&&d(k)}},h=function(){let k,l,m,j=jQuery('.tsfem-form-multi-select-wrap[data-required="1"]');j.each(function(n,o){l=o.dataset.requiredCheckCount,void 0==l&&(k=jQuery(o),k.find('input').on('change.tsfemForm.testChecked',g),m=k.find('input:checked').length,m?k.addClass('tsfem-form-multi-valid'):d(k),c(k,+m))})};h(),jQuery(window).on('tsfemForm.iterationComplete',h)},setupTypeListener:function(){const a=function(d,f){let g;if('object'==typeof d)for(let h in d)if(g=a(d[h],f),!1!==g)return h;return f===d&&f},b=function(d){let f,g,h;return(d.target.dataset.typeInitTested=1,f=d.target.value,!f)?(d.target.dataset.type='',void jQuery(d.target).trigger('tsfemForm.typeIsSet')):void(g=tsfemForm.parseElementData(d.target,'setTypeToIfValue'),g&&(h=a(g,f),d.target.dataset.type=h||'',jQuery(d.target).trigger('tsfemForm.typeIsSet')))},c=function(){let f,d=jQuery('[data-is-type-listener="1"]');d.each(function(h,j){j.dataset.typeInitTested||(f=jQuery(j),f.on('change.tsfemForm.typeListener',b),f.trigger('change.tsfemForm.typeListener'))})};c(),jQuery(window).on('tsfemForm.iterationComplete',c)},setupShowIfListener:function(){let a='input, select, textarea',b={duration:250,easing:'linear',queue:!1,start:function(){this.style.willChange='height, margin, padding'},done:function(){let n=this.style.display;this.removeAttribute('style'),this.style.display=n}};const c=function(n){let p,o=n.dataset.isShown||void 0;try{p=JSON.parse(o)}catch(q){}if(p)for(let q in p)if(-1==+p[q])return!1;return!0},d=function(n,o,p){let r,q=n.dataset.isShown||void 0;try{r=JSON.parse(q)}catch(s){}return(r=r||{},!(r.hasOwnProperty(o)&&+p==+r[o]))&&(r[o]=+p,n.dataset.isShown=JSON.stringify(r),!0)},f=function(n,o){let p=n.dataset.disabledShowif;return n.dataset.disabledShowif=p?+p+o:+o},g=function(n,o){if(d(n,o,-1)){let p=jQuery(n);p.is(a)?(p.closest('.tsfem-form-setting').slideUp(b),n.disabled=!0,f(n,1),tsfemForm.triggerCustomValidation(n)):(p.slideUp(b),p.find(a).each(function(r,s){s.disabled=!0,f(s,1),tsfemForm.triggerCustomValidation(s)}))}},h=function(n,o){if(d(n,o,1)){let p=jQuery(n);if(p.is(a))1>f(n,-1)&&(n.disabled=!1,tsfemForm.triggerCustomValidation(n),p.closest('.tsfem-form-setting').slideDown(b));else{let r,q=p.hasClass('tsfem-form-multi-setting');p.find(a).each(function(s,t){return r=f(t,-1),q&&!c(t)||void(1>r&&(t.disabled=!1,tsfemForm.triggerCustomValidation(t),jQuery(t).show()))}),p.slideDown(b)}}},j=function(n,o,p){let q={};jQuery(o).on('tsfemForm.typeIsSet',n,function(){clearTimeout(q[o.id]),q[o.id]=setTimeout(function(){o.dataset.type===p?h(n,o.id):g(n,o.id),delete q[o.id]},250)}),o.dataset.type===p?h(n,o.id):g(n,o.id)},k=function(n){let o=tsfemForm.parseElementData(n,'showif');if(o){let p,r,q=jQuery(n).closest('.tsfem-form-collapse-content');for(r in o)break;if(r)return p=q?q.find('[data-showif-catcher="'+r+'"]'):jQuery(n.form).find('[data-showif-catcher="'+r+'"]'),p.length?{target:p[0],value:o[r]}:void 0}},l=function(n){n.dataset.showIfIsInit='1';let o=k(n);o&&j(n,o.target,o.value)},m=function(){let n=jQuery('[data-is-showif-listener="1"]');n.each(function(o,p){p.dataset.showIfIsInit||l(p)})};m(),jQuery(window).on('tsfemForm.iterationComplete',m)},adjustSubmit:function(){let a=jQuery('form.tsfem-form');a.each((b,c)=>{jQuery(document.querySelector('[type=submit][form="'+c.id+'"]')).attr('onclick','tsfemForm.saveInput( event )')})},doValidityRoutine:function(a,b){if(b=b||tsfemFormL10n.i18n.collapseValidate,!a.checkValidity()){let c=a.querySelector('input:invalid, select:invalid, textarea:invalid'),d=!1;const f=function(){if(d)return void g();try{return void c.reportValidity()}catch(h){tsfem.debug&&console.log(h)}},g=function(){let h=jQuery(c).parents('.tsfem-form-collapse'),j=-1;if(h=jQuery(h.get().reverse()),jQuery(h).each((q,r)=>{let s=jQuery(r).children('.tsfem-form-collapse-checkbox').is(':checked');if(s)return j=q,!1}),-1===j)return d=!1,f();d=!0;let k,l,m;k=h.slice(j).first(),l=k.find('.tsfem-form-collapse-header').first(),m=k.find('.tsfem-form-collapse-checkbox').first();let n;tsfem.doTooltip(void 0,l,b),function(q,r){clearTimeout(n),n=setTimeout(function(){let s=q.offset().top+r.prop('scrollTop')-r.offset().top-r.position().top;r.prop('scrollHeight')>r.prop('clientHeight')&&r.animate({scrollTop:s},500)},50)}(l,l.closest('.tsfem-pane-inner-wrap')),m.off('change.tsfemForm.removeToolTip'),m.on('change.tsfemForm.removeToolTip',function(q){let r=jQuery(q.target);tsfem.removeTooltip(r.siblings('.tsfem-form-collapse-header')),r.off('change.tsfemForm.removeToolTip'),g()})};return c?g():f(),!1}return!0},saveInput:function(a){tsfemForm.preventSubmit(a);let c,d,b=a.target.getAttribute('form');if(b){if(c=document.getElementById(b),!c)return tsfemForm.preventSubmit(a);if(!tsfemForm.doValidityRoutine(c,tsfemFormL10n.i18n.collapseValidate))return;d=a.target}else c=a.target,d=document.querySelector('[type=submit][form="'+c.id+'"]');let f=jQuery(c).closest('.tsfem-pane-wrap').find('.tsfem-pane-header .tsfem-ajax'),g=0,h='';return tsfemForm.disableButton(d),tsfem.resetAjaxLoader(f),tsfem.setAjaxLoader(f),jQuery.ajax({method:'POST',url:ajaxurl,dataType:'json',data:{action:'tsfemForm_save',nonce:tsfemForm.nonce,data:jQuery(c).serialize()},processData:!0,timeout:14000,async:!0}).done(function(j){j=tsfem.convertJSONResponse(j),tsfem.debug&&console.log(j);let k=j&&j.data||void 0,l=j&&j.type||void 0;if(!k||!l)h=tsfem.i18n.InvalidResponse;else{let m=k.results&&k.results.code||void 0;m?(g=1,tsfem.setTopNotice(m)):h=tsfem.i18n.UnknownError}}).fail(function(j,k,l){h=tsfem.getAjaxError(j,k,l),tsfem.setTopNotice(1071101),l&&tsfem.setTopNotice(-1,'jQ error: '+l)}).always(function(){tsfem.updatedResponse(f,g,h,0),tsfemForm.enableButton(d)}),!0},preventSubmit:function(a){return a.preventDefault(),a.stopPropagation(),!1},enableButton:function(a){setTimeout(function(){let b=jQuery(a);b.removeClass('tsfem-button-disabled tsfem-button-loading'),b.attr('disabled',!1)},1)},disableButton:function(a,b){b=!(void 0!==b)||b;let c=jQuery(a);b?c.addClass('tsfem-button-disabled tsfem-button-loading'):c.addClass('tsfem-button-disabled'),c.attr('disabled',!0)},enableSubmit:function(a){a&&a.id&&tsfemForm.enableButton('[form="'+a.id+'"]')},disableSubmit:function(a,b){a&&a.id&&tsfemForm.disableButton('[form="'+a.id+'"]',b)},doReady:function(){tsfemForm.setupIterations(),tsfemForm.setupGeo(),tsfemForm.setupSpecialRequired(),tsfemForm.setupTypeListener(),tsfemForm.setupShowIfListener(),tsfemForm.adjustSubmit()},ready:function(a){a(document.body).ready(tsfemForm.doReady)}},jQuery(tsfemForm.ready);
